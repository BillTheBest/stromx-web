<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>stromx-web</title>
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <script src="js/libs/jquery-1.10.2.js"></script>
  <script src="js/libs/handlebars-v1.1.2.js"></script>
  <script src="js/libs/bootstrap.js"></script>
  <script src="js/libs/ember.js"></script>
  <script src="js/libs/ember-data.js"></script>
  <script src="js/libs/snap.svg.js"></script>
  <script src="js/application.js"></script>
  <script src="js/router.js"></script>
  <script src="js/controllers/application_controller.js"></script>
  <script src="js/controllers/error_controller.js"></script>
  <script src="js/controllers/operator_controller.js"></script>
  <script src="js/controllers/parameter_controller.js"></script>
  <script src="js/controllers/file_controller.js"></script>
  <script src="js/controllers/filesAdd_controller.js"></script>
  <script src="js/controllers/filesNew_controller.js"></script>
  <script src="js/controllers/stream_controller.js"></script>
  <script src="js/models/store.js"></script>
  <script src="js/models/model.js"></script>
  <script src="js/views/upload_file.js"></script>
  
  <script type="text/x-handlebars" data-template-name="application">
    <div class="container">
      <div class="row">
        <div class="col-sm-2"></div>
        <div class="col-sm-8">
          {{outlet}}
        </div>
        <div class="col-sm-2"></div>
      </div>

      {{#if length}}
      <div class="well">
        {{#each itemController="error"}}
          <p>{{time}}: {{description}}</p>
        {{/each}}
      </div>
      <button {{action "clearErrors"}} class="btn btn-default btn-xs pull-left">Clear Errors</button>
      {{/if}}
    </div>
  </script>

  <script type="text/x-handlebars" data-template-name="files">
    <h1>Files</h1>
    <div class="stromx-center-buttons">
      <div class="btn-group">
        {{#link-to 'files.new' type="button" class="btn btn-default"}}New File{{/link-to}}
        {{#link-to 'files.add' type="button" class="btn btn-default"}}Upload File{{/link-to}}
      </div>
    </div>
    {{outlet}}
    <table class="table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Status</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {{#each itemController="file"}}
          <tr>
            <td>
              {{name}}
            </td>
            <td>
              {{#if closed}}
                Closed
              {{else}}
                Loaded
              {{/if}}
            </td>
            <td>
              {{#if closed}}
                <div class="btn-group">
                  <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown">
                    Action <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu">
                    <li><a {{action "open"}}>Open</a></li>
                    <li><a {{action "rename"}}>Rename</a></li>
                    <li><a {{action "remove"}}>Remove</a></li>
                    <li><a {{bind-attr href=url}}>Download</a></li>
                  </ul>
                </div>
              {{else}}
                <div class="btn-group">
                  <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown">
                    Action <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu" role="menu">
                    {{#each stream}}
                      <li>{{#link-to 'stream' this}}Show{{/link-to}}</li>
                    {{/each}}
                    <li><a {{bind-attr href=url}}>Download</a></li>
                  </ul>
                </div>
              {{/if}}
            </td>
          </tr>
        </tr>
        {{/each}}
      </tbody>
    </table>
  </script>

  <script type="text/x-handlebars" data-template-name="files/add">
    <div class="panel panel-default">
      <div class="panel-body">
        <div class="form-group">
          <label for="uploadFile">File</label>
          {{view App.UploadFile valueBinding="name" content=content id="uploadFile"}}
          <p class="help-block">Choose a valid stromx file.</p>
        </div>
        <button {{action 'addFile'}} type="submit" class="btn btn-default">Save</button>
      </div>
    </div>
  </script>

  <script type="text/x-handlebars" data-template-name="files/new">
    <div class="panel panel-default">
      <div class="panel-body">
        <div class="form-group">
          <label for="newFile">Filename</label>
          {{input valueBinding="name" class="form-control" placeholder="Enter filename" id="newFile"}}
        </div>
        <button {{action 'newFile'}} type="submit" class="btn btn-default">Save</button>
      </div>
    </div>
  </script>

  <script type="text/x-handlebars" data-template-name="stream">
    <h1>Stream</h1>
    <div class="stromx-center-buttons">
      {{#if active}}   
        {{#if paused}}   
          <div class="btn-group">
            <button type="button" {{action "resume" }} class="btn btn-default">Resume</button>
            <button type="button" {{action "stop"}} class="btn btn-default">Stop</button>
          </div>
        {{else}}     
          <div class="btn-group">
            <button type="button" {{action "pause"}} class="btn btn-default">Pause</button>
            <button type="button" {{action "stop"}} class="btn btn-default">Stop</button>
          </div>
        {{/if}}
      {{else}}     
        <div class="btn-group">
          <button type="button" {{action "start"}} class="btn btn-default">Start</button>
          <button type="button" {{action "close"}} class="btn btn-default">Close</button>
        </div>
      {{/if}}
    </div>
    <table class="table">
      <thead>
        <tr>
          <th>Operator</th>
          <th>Type</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {{#each operators itemController="operator"}}
          <tr>
            <td>
              {{name}}
            </td>
            <td>
              {{fullType}}
            </td>
            <td>
              {{#link-to 'operator' this type="button" class="btn btn-default btn-xs"}}Show{{/link-to}}
            </td>
          </tr>
        </tr>
        {{/each}}
      </tbody>
    </table>
  </script>

  <script type="text/x-handlebars" data-template-name="operator">
    <h1>Operator</h1>

    <table class="table">
      <thead>
        <tr>
          <th>Property</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            Type
          </td>
          <td>
            {{fullType}}
          </td>
        </tr>
        <tr>
          <td>
            Version
          </td>
          <td>
            {{version}}
          </td>
        </tr>
        <tr>
          <td>
            Status
          </td>
          <td>
            {{status}}
          </td>
        </tr>
        <tr>
          <td>
            Name
          </td>
          <td>
            {{#if isEditingName}}
              {{input value=name}}
              <button type="button" {{action "saveName"}} class="btn btn-default btn-xs">Save</button>
            {{else}}
              {{name}} 
              <button type="button" {{action "editName"}} class="btn btn-default btn-xs">Edit</button>
            {{/if}}
          </td>
        </tr>
      </tr>
        {{#each parameters itemController="parameter"}}
          <tr>
            <td>
              {{title}}
            </td>
            <td>    
              {{#if isEditing}}
                {{#if isEnum}}
                  {{view Ember.Select content=descriptions optionValuePath="content.value" 
                    optionLabelPath="content.title" value=numberValue}}
                {{else}}
                  {{input value=editValue}}
                {{/if}}
                <button type="button" {{action "saveValue"}} class="btn btn-default btn-xs">Save</button>
              {{else}}
                {{#if timedOut}}
                  <em>Access timed out</em>
                  <button type="button" {{action "reload"}} class="btn btn-default btn-xs">Retry</button>
                {{else}}
                  {{displayValue}} 
                  {{#if writable}}
                    <button type="button" {{action "editValue"}} class="btn btn-default btn-xs">Edit</button>
                  {{/if}}
                {{/if}}
              {{/if}}
            </td>
          </tr>
        </tr>
        {{/each}}
      </tbody>
    </table>
  </script>
</body>
</html>
